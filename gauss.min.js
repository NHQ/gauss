var Vector=function(h){var c=!(h instanceof Array)?Array.prototype.slice.call(arguments):h;0===Array.prototype.slice.call(arguments).length&&(c=[]);var j=function(b,a){return b-a};Object.defineProperties(c,{sum:{value:function(b){for(var a=0,d=0;d<c.length;)a+=c[d++];return b?b(a):a},writable:!0,enumerable:!1},product:{value:function(b){for(var a=0,d=1;a<c.length;)d*=c[a++];return b?b(d):d},writable:!0,enumerable:!1},mean:{value:function(b){var a=c.sum()/c.length;return b?b(a):a},writable:!0,enumerable:!1},
gmean:{value:function(b){var a=Math.pow(Math.abs(c.product()),1/c.length);return b?b(a):a},writable:!0,enumerable:!1},hmean:{value:function(b){for(var a=c.length,d=c,e=0,f=0;e<d.length;)f+=1/Math.abs(d[e++]);a/=f;return b?b(a):a},writable:!0,enumerable:!1},qmean:{value:function(b){var a=Math.sqrt(c.pow(2).sum()/c.length);return b?b(a):a},writable:!0,enumerable:!1},median:{value:function(b){var a=c.copy();a.sort(j);a=0===c.length%2?(a[c.length/2-1]+a[c.length/2])/2:a[parseInt(c.length/2)];return b?
b(a):a},writable:!0,enumerable:!1},mode:{value:function(b){for(var a={},d=1,e=new Vector,f=0;f<c.length;f++){var g=c[f];null==a[g]?a[g]=1:a[g]++;a[g]>d?(e=new Vector(g),d=a[g]):a[g]==d&&(e.push(g),d=a[g])}1===e.length&&(e=e[0]);return b?b(e):e},writable:!0,enumerable:!1},range:{value:function(b){var a=c.max()-c.min();return b?b(a):a},writable:!0,enumerable:!1},variance:{value:function(b){for(var a=0,d=0;a<c.length;)d+=Math.pow(c[a++]-c.mean(),2);d/=c.length;return b?b(d):d},writable:!0,enumerable:!1},
stdev:{value:function(b,a){var d=0;if(b)return c.density(b).stdev();d=Math.sqrt(c.variance());return a?a(d):d},writable:!0,enumerable:!1},frequency:{value:function(b,a){var d=0;-1!==c.indexOf(b)&&(d=c.copy(),d.sort(j),d=d.lastIndexOf(b)-d.indexOf(b)+1);return a?a(d):d},writable:!0,enumerable:!1},percentile:{value:function(b,a){var d=c.copy();d.sort(j);var e=d[0];0<b&&(e=d[Math.floor(c.length*b)]);return a?a(e):e},writable:!0,enumerable:!1},density:{value:function(b,a){var d;d=c.copy();d.sort(j);if(1==
b)return d;var e=Math.round(c.length*(0.5-b/2)-1),f=Math.round(c.length*(0.5+b/2)-1);d=new Vector(d.slice(e,f));return a?a(d):d},writable:!0,enumerable:!1},distribution:{value:function(b,a){var d=c.copy();d.sort(j);var e=function(a,b,d,c){if(b===a.length)return c;c[a[b]]="relative"===d?a.frequency(a[b])/a.length:a.frequency(a[b]);return e(a,a.lastIndexOf(a[b])+1,d,c)},d="relative"===b?e(d,0,"relative",{}):e(d,0,"raw",{});return a?a(d):d},writable:!0,enumerable:!1},quantile:{value:function(b,a){var d=
c.copy();d.sort(j);var e=1/b,f=new Vector;if(b>c.length)throw new RangeError("Subset quantity is greater than the Vector length");for(var g=e;1>g;g+=e){var h=Math.round(d.length*g)-1;h<d.length-1&&f.push(d[h])}return a?a(f):f},writable:!0,enumerable:!1},delta:{value:function(b){for(var a=new Vector,d=1;d<c.length;d++)a.push(c[d]-c[d-1]);return b?b(a):a},writable:!0,enumerable:!1},sma:{value:function(b,a){var d;if(1===b)d=c;else{var e=(new Vector(c.slice(0,b))).sum();d=new Vector([e/b]);for(var f=
1;f<c.length-b+1;f++)e+=c[f+b-1]-c[f-1],d.push(e/b)}return a?a(d):d},writable:!0,enumerable:!1},ema:{value:function(b,a){"number"===typeof b&&(b={period:b,ratio:function(a){return 2/(a+1)}});for(var d=(new Vector(c.slice(0,b.period))).sum(),d=new Vector([d/b.period]),e=b.ratio(b.period),f=1;f<c.length-b.period+1;f++)d.push(e*(c[f+b.period-1]-d[f-1])+d[f-1]);return a?a(d):d},writable:!0,enumerable:!1},max:{value:function(b){var a=Math.max.apply({},c);return b?b(a):a},writable:!0,enumerable:!1},min:{value:function(b){var a=
Math.min.apply({},c);return b?b(a):a},writable:!0,enumerable:!1},abs:{value:function(b){var a=c.map(function(a){return Math.abs(a)});return b?b(a):a},writable:!0,enumerable:!1},acos:{value:function(b){var a=c.map(function(a){return Math.acos(a)});return b?b(a):a},writable:!0,enumerable:!1},asin:{value:function(b){var a=c.map(function(a){return Math.asin(a)});return b?b(a):a},writable:!0,enumerable:!1},atan:{value:function(b){var a=c.map(function(a){return Math.atan(a)});return b?b(a):a},writable:!0,
enumerable:!1},ceil:{value:function(b){var a=c.map(function(a){return Math.ceil(a)});return b?b(a):a},writable:!0,enumerable:!1},cos:{value:function(b){var a=c.map(function(a){return Math.cos(a)});return b?b(a):a},writable:!0,enumerable:!1},exp:{value:function(b){var a=c.map(function(a){return Math.exp(a)});return b?b(a):a},writable:!0,enumerable:!1},floor:{value:function(b){var a=c.map(function(a){return Math.floor(a)});return b?b(a):a},writable:!0,enumerable:!1},log:{value:function(b){var a=c.map(function(a){return Math.log(a)});
return b?b(a):a},writable:!0,enumerable:!1},pow:{value:function(b,a){var d=c.map(function(a){return Math.pow(a,b)});return a?a(d):d},writable:!0,enumerable:!1},round:{value:function(b){var a=c.map(function(a){return Math.round(a)});return b?b(a):a},writable:!0,enumerable:!1},sin:{value:function(b){var a=c.map(function(a){return Math.sin(a)});return b?b(a):a},writable:!0,enumerable:!1},sqrt:{value:function(b){var a=c.map(function(a){return Math.sqrt(a)});return b?b(a):a},writable:!0,enumerable:!1},
tan:{value:function(b){var a=c.map(function(a){return Math.tan(a)});return b?b(a):a},writable:!0,enumerable:!1},clone:{value:function(b){var a=c instanceof Array?[]:{};for(i in c)"clone"!==i&&(a[i]=c[i]&&"object"===typeof c[i]?c[i].clone():c[i]);return b?b(a):a},writable:!0,enumerable:!1},copy:{value:function(b){var a=new Vector(c.slice());return b?b(a):a},writable:!0,enumerable:!1},toArray:{value:function(b){var a=Array.prototype.slice.call(c);return b?b(a):a},writable:!0,enumerable:!1},concat:{value:function(b){var a=
Array.prototype.slice.call(arguments),d=a[a.length-1];return"function"===typeof d?"number"!==typeof a[0]?d(new Vector(c.toArray().concat(a[0]))):d(new Vector(c.toArray().concat(a.slice(0,a.length-1)))):"number"!==typeof a[0]?new Vector(c.toArray().concat(a[0])):new Vector(c.toArray().concat(a))},writable:!0,enumerable:!1},slice:{value:function(b,a,d){var e=Array.prototype.slice.call(arguments);return 3===e.length?d(new Vector(c.toArray().slice(b,a))):2===e.length?"function"===typeof e[1]?d(new Vector(c.toArray().slice(b))):
new Vector(c.toArray().slice(b,a)):1===e.length?new Vector(c.toArray().slice(b)):new Vector(c.toArray().slice())},writable:!0,enumerable:!1},filter:{value:function(b,a){var d=new Vector(c.toArray().filter(b));return a?a(d):d},writable:!0,enumerable:!1},every:{value:function(b,a){var d=c.toArray().every(b);return a?a(d):d},writable:!0,enumerable:!1},map:{value:function(b,a){var d=new Vector(c.toArray().map(b));return a?a(d):d},writable:!0,enumerable:!1},some:{value:function(b,a){var d=c.toArray().some(b);
return a?a(d):d},writable:!0,enumerable:!1},reduce:{value:function(b,a,d){var e=Array.prototype.slice.call(arguments);return 3===e.length?d(c.toArray().reduce(b,a)):2===e.length?"function"===typeof e[1]?d(c.toArray().reduce(b)):c.toArray().reduce(b,a):c.toArray().reduce(b)},writable:!0,enumerable:!1},reduceRight:{value:function(b,a,d){var e=Array.prototype.slice.call(arguments);return 3===e.length?d(c.toArray().reduceRight(b,a)):2===e.length?"function"===typeof e[1]?d(c.toArray().reduceRight(b)):
c.toArray().reduceRight(b,a):c.toArray().reduceRight(b)},writable:!0,enumerable:!1}});return c};Array.prototype.toVector=function(){return new Vector(this)};
var TimeSeries=function(h){var c=2===arguments.length?Array.prototype.slice.call(arguments):h;0===Array.prototype.slice.call(arguments).length&&(c=[]);Object.defineProperties(c,{byValue:{value:function(c,b){return c[1]<b[1]?-1:c[1]>b[1]?1:0},writable:!0,enumerable:!1},byDate:{value:function(c,b){return c[0]<b[0]?-1:c[0]>b[0]?1:0},writable:!0,enumerable:!1},times:{value:function(c){var b=new Vector(Array.prototype.map.call(this,function(a){return a[0]}));return c?c(b):b},writable:!0,enumerable:!1},
values:{value:function(c){var b=new Vector(Array.prototype.map.call(this,function(a){return a[1]}));return c?c(b):b},writable:!0,enumerable:!1}});return c},gauss={Vector:Vector,TimeSeries:TimeSeries};